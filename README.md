# QR Code Generator

This is simple QRCode generator. It uses bacon/bacon-qr-code library.

## Aim

To refresh my memory on setting up projects in PHP without any framework.
 
### Features 
 
1. API request authentication
2. QR Code generation
3. Store links to QR Code images
4. Admin can retrieve a list of all QR codes generated.
5. Admin can retrieve the text of all QR codes generated.

### Tools

1. PHP
2. MYSQL
3. Composer
4. Postman
5. Libraries: see composer.json

### Project approach

#### Objects
1. Admin
2. QR Code

#### Schema

1. admin - id:int - primary key, username:string, password:text, created_at, updated_at.
2. image - id:int - primary key, file_path, qrcode_text, created_at, updated_at.
3. super_admin - id:int - primary key, username:string, password:text, created_at, updated_at.

#### Migrations

robmorgan/phinx library manages schema migrations.

#### API 
##### Authentication
I manually added super-admin details to the database. 
Only a super-admin can create admin accounts. 

If valid parameters are supplied, the response shall with a token for super-admin privileges.

##### Endpoints

&nbsp; 1. POST /super-admin

Request sample:
```json
 {
    "username": "sa_username",
    "password": "sa_password"
}
```

Response sample:
```json
{
"data":
  {
    "message":"super admin token created",
    "token":"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJzeXN0ZW1fZHJvaWQiLCJpYXQiOjE1OTE2Mzc3MDksImV4cCI6MTU5MTY0MTMwOSwibmFtZSI6Imphc25haCJ9.VRl-BZ_xUB-lZbqNC6niT7xcffmaZiWqdcPqJwPWOms"
  }
}
```

&nbsp; 2. POST /admin

Uses token generated by super admin to create an ordinary admin for the system.

Request sample:
```json
{
	"username": "John",
    "password": "Doe",
    "token": "Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJzeXN0ZW1fZHJvaWQiLCJpYXQiOjE1OTE2Mzc3MDksImV4cCI6MTU5MTY0MTMwOSwibmFtZSI6Imphc25haCJ9.VRl-BZ_xUB-lZbqNC6niT7xcffmaZiWqdcPqJwPWOms"
}
```

Response sample:
```json
{
  "data": {
    "message":"new admin created"
   }
}
```

&nbsp; 3. POST /admin/signin

An existing admin can obtain token to perform admin functions.

Request sample:
```json
{
	"username": "baji",
    "password": "krini"
}
```

Response sample:
```json
{
  "data":
  {
    "message":"admin sign in successful",
    "token":"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJzeXN0ZW1fZHJvaWQiLCJpYXQiOjE1OTE2Mzc5MDYsImV4cCI6MTU5MTY0MTUwNiwibmFtZSI6ImJhamkifQ.RhacilOBFjtemWfFoJqnWwdqrdg-uZWKFIb1Yb0x2VA"
  }
}
```

&nbsp; 4. GET /admin/images

Admin can retrieve all QR code images using the token generated. 

Add a 'Token' parameter to the request header. The value of the token should start with 'Bearer ', then, the token follows. 
  
Request sample:

`"Token"` => `"Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJzeXN0ZW1fZHJvaWQiLCJpYXQiOjE1OTE2Mzc5MDYsImV4cCI6MTU5MTY0MTUwNiwibmFtZSI6ImJhamkifQ.RhacilOBFjtemWfFoJqnWwdqrdg-uZWKFIb1Yb0x2VA"`

Response sample:

```json
{
  "data":
  {
    "message":"All images retrieved!",
    "images":[https://www.myserver.com/link-to-image]
  }
}
```

Sample qr code generated

![Image](https://raw.githubusercontent.com/dipperLyra/qrcode-generator/master/src/files/qrcode.png)


&nbsp; 5. POST /qrcode

For any object of valid credentials, it would generate an image of QR code.

Request sample:
```json
{
  "text": "foo bar"
}
```

Response sample:
```json
{
  "data": 
  {
    "message": "QR Code created!"
  }
}
```
